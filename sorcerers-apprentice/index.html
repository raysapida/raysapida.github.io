
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Sorcerer's Apprentice - Problems With Deploying - Ray's Blog</title>
  <meta name="author" content="Raymond Sapida">

  
  <meta name="description" content="I was browsing through Netflix trying to find something to fill the
room with white noise while I studied when I decided on Fantasia. At one point &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://raysapida.github.io/sorcerers-apprentice/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Ray's Blog" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-57189071-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Ray's Blog</a></h1>
  
    <h2>All About Web Development</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="sitesearch" value="raysapida.github.io">
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Sorcerer's Apprentice - Problems With Deploying</h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-03-22T00:00:00-07:00'><span class='date'><span class='date-month'>Mar</span> <span class='date-day'>22</span><span class='date-suffix'>nd</span>, <span class='date-year'>2015</span></span> <span class='time'>12:00 am</span></time>
        
      </p>
    
  </header>


<div class="entry-content"><p>I was browsing through Netflix trying to find something to fill the
room with white noise while I studied when I decided on Fantasia. At one point during the movie, the
conductor turns towards the audience to explain the concept behind one of the
pieces; Sorcerer&rsquo;s Apprentice. An apprentice tried to use magic that he
couldn&rsquo;t control and wasn&rsquo;t stopped until his master came to fix the situation.
I think programming has a lot of these situations and the scariest mistake for
me is deployment.</p>

<p>Even little tests apps scare me because of the possibility that I&rsquo;m sharing api
keys or passwords. Right now, the only key I&rsquo;m using that shouldn&rsquo;t be in the
repository is the <code>SECRET_KEY_BASE</code> generated by <code>rake secret</code>. I&rsquo;m currently
learning about the use of <a href="https://github.com/bkeepers/dotenv">dotenv</a> which
extracts the key into a <code>.env</code> file and substitutes an environment variable in
<a href="http://guides.rubyonrails.org/4_1_release_notes.html#config-secrets-yml">config/secrets.yml</a>.
Before this method, I wouldn&rsquo;t commit the <code>secrets.yml</code> into the repository.</p>

<p>With a particular <a href="https://github.com/raysapida/mustached-octo-robot">app</a>, I was
having problems with deploying it after I updated the gems. I incrementally
updated Rails and Ruby versions making sure that all the tests pass. Because
of this process, I was sure that the problem involves the database or
gem/feature I added but didn&rsquo;t test. The app was hosted on heroku and the first
thing I did was look at the log by running <code>heroku logs --tail</code>. I wasn&rsquo;t sure
what the error message was saying so my first instinct was to reproduce the situation on my
computer.</p>

<p>Before this, I was using vagrant to configure my environment and the Vagrantfile
was configuring the database for me. Now that I&rsquo;ve installed <a href="http://ubuntugnome.org/">Ubuntu Gnome</a>
on my computer, I needed to create a Postgres database for a local
development environment along with an associated user. After <a href="https://www.digitalocean.com/community/tutorials/how-to-install-and-use-postgresql-on-ubuntu-14-04">installing Postgres</a>,
I created a database and  an associated user for the app.</p>

<h2>Postgres commands I needed to use: <a href="http://stackoverflow.com/questions/19953653/how-to-set-up-postgres-database-for-local-rails-project">Stackoverflow link</a></h2>

<p><code>create user username with password 'password';</code></p>

<p><code>alter user username superuser;</code></p>

<p><code>create database projectname_development;</code></p>

<p><code>grant all privileges on database projectname_development to username;</code></p>

<h2>Fixing the problem</h2>

<p>After going through these steps and connecting Postgres with the development
environment by editing the <code>database.yml</code> file, I found the same error recorded
at the heroku logs. The error message was saying that it was using a Ruby version 2.2.0 when I was
using 2.2.1 and that there was a problem parsing the yaml file of the Jekyll
blog. I was able to fix it on my computer by resetting rvm and making sure it
was using the correct Ruby version, but I didn&rsquo;t know how to do the same thing for
heroku. Based on the messages during deployment, the problem seems like it
originates from my <code>Gemfile.lock</code> file. I originally started working on the app in
a Windows environment, migrating it to a virtual machine through Vagrant, and
then to an Ubuntu laptop now. Heroku had to redo <code>bundle install</code> after each
deployment because of the fact that it doesn&rsquo;t use the <code>Gemfile.lock</code> file due to the
Windows line endings.</p>

<p>I deleted that file and reran
<code>bundle install</code>. Also, since the <a href="https://github.com/zbruhnke/bloggy">bloggy gem</a>
was throwing the error and I was already planning to remove it in the future, I decided
to uninstall it as well. I&rsquo;m aiming to add a different blogging engine or a basic
Rails one so that the layouts would not be separate from the Rails app. This way,
I would be able to write unit tests for it in the future. Jekyll is a static site generator and I
don&rsquo;t know how to create a proper test for it besides making sure that
<code>jekyll build</code> wasn&rsquo;t throwing any errors. Afterwards,
<code>heroku run rake db:migrate</code> was successful and the app was running again.</p>

<h2>Links I&rsquo;ve been reading</h2>

<ul>
<li><p><a href="http://genua.github.io/ruby/2015/03/04/underscores-ampersands-asterisks/">Ruby 2.1 - Fun with underscores, ampersands and
asterisks</a>:
I&rsquo;ve used asterisks as a splat operator and ampersands for blocks but this is the first time that
I&rsquo;ve seen underscores used to fill in for an unneeded argument.</p></li>
<li><p><a href="https://robots.thoughtbot.com/a-closer-look-at-test-spies">A Closer Look at Test Spies</a>:
This article is exploring the use of the <code>spy</code> method instead of <code>double</code> to
set up tests. The main difference is using the <code>spy</code> method
would automatically spy on all methods without having to stub it out. The main
issue is that stubbing is usually a good indicator of the class&rsquo;s design. You
should&rsquo;t have to stub multiple methods to pass a test for classes that are designed
well because it would have to many responsibilities</p></li>
<li><p><a href="http://6ftdan.com/allyourdev/2015/03/20/hooks/">Hooks</a>:
I&rsquo;ve only seen <code>extended</code> and <code>included</code> as hooks and this blog post provides a whole list of hooks used in Ruby.</p></li>
<li><p><a href="https://blog.engineyard.com/2015/understanding-rack-apps-and-middleware">Understanding Rack Apps and Middleware</a>:
This is an in-depth post about Rack. I&rsquo;ve read about them from different
articles before but this one incorporates a lot of information into a single
post.</p></li>
<li><p><a href="http://code.tutsplus.com/articles/nginx-guide-introduction--cms-21877">Nginx Guide:
Introduction</a>:
This article is an introduction of what Nginx is and its advantages. I&rsquo;m not
familiar with how servers are set up because Heroku handles it&rsquo;s management
but it&rsquo;s something I want to learn more about in the future.</p></li>
<li><p><a href="https://cssanimation.rocks/principles/">Animation Principles for the Web</a>:
This article applies Disney&rsquo;s 12 Principles of Animation to CSS. I was
introduced to those CSS properties in Upcase&rsquo;s CSS trails and this article was
trying to illustrate how to use those properties effectively.</p></li>
<li><p><a href="http://5by5.tv/rubyonrails/186">Ruby on Rails Podcast: Darrell Silver from Thinkful</a>:
I was listening to this podcast and the part where Sean Devine talked about his
experience trying a service that helps beginners resonated with me. He
talked about the other person&rsquo;s guilt because they had been working so much and
they felt like they should already know the answer. Even though the solution was
technically simple, the host was saying most of the problem was dealing with
that guilt and leading them to a place where they could program again.</p></li>
</ul>

</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Raymond Sapida</span></span>

      




<time class='entry-date' datetime='2015-03-22T00:00:00-07:00'><span class='date'><span class='date-month'>Mar</span> <span class='date-day'>22</span><span class='date-suffix'>nd</span>, <span class='date-year'>2015</span></span> <span class='time'>12:00 am</span></time>
      


    </p>
    
      <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://raysapida.github.io/sorcerers-apprentice/" data-via="" data-counturl="http://raysapida.github.io/sorcerers-apprentice/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/essential-online-accounts/" title="Previous Post: Accounts I should have had from the beginning">&laquo; Accounts I should have had from the beginning</a>
      
      
        <a class="basic-alignment right" href="/easy-wins-vs-hard-wins/" title="Next Post: Easy Wins versus Hard Wins">Easy Wins versus Hard Wins &raquo;</a>
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/writing-html-and-css-from-a-specific-design/">Writing Html and Css From a Specific Design</a>
      </li>
    
      <li class="post">
        <a href="/thinkful-front-end-developer-course/">Going Through Thinkful's Front End Course</a>
      </li>
    
      <li class="post">
        <a href="/preparing-a-resume/">Preparing a Resume</a>
      </li>
    
      <li class="post">
        <a href="/vim-snippets-cheatsheet/">Snippets Cheat Sheet</a>
      </li>
    
      <li class="post">
        <a href="/vim-cheatsheet/">Vim Cheat Sheet</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/raysapida">@raysapida</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'raysapida',
            count: 31,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2015 - Raymond Sapida -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'raysapida';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
